## v1签名(初代)
apk 本质是个 zip 文件，解压缩后，在 META-INFO 
文件夹中可以看到有 MANIFEST.MF、CERT.SF、CERT.RSA 三个文件。
这三个文件在签名时创建，在安装时用于验证签名。
- 签名的流程如下：
 1. 计算每一个原始文件的 SHA-1 摘要，写入到 MANIFEST.MF 中；
 2. 计算整个 MANIFEST.MF 文件的 SHA-1 摘要，写入到 CERT.SF 中；
 3. 计算 MANIFEST.MF 中，每一块的 SHA-1 摘要，写入到 CERT.SF 中；
 4. 计算整个 CERT.SF 文件的摘要，使用开发者私钥计算出摘要的签名；
 5. 将签名和开发者证书(X.509)写入 CERT.RSA 。

- 校验的流程如下：
 1. 取出 CERT.RSA 中包含的开发者证书；
 2. 通过系统的根证书（CA证书）验证这个开发者证书是否可信；
 3. 如果开发者证书可信，用证书中的公钥解密 CERT.RSA 中包含的签名。
 4. 计算 CERT.SF 的签名；
 5. 对比 (3) 和 (4) 的签名是否一致；
 6. 如果一致，用 CERT.SF 去校验 MANIFEST.MF 是否被修改；
 7. 如果没有被修改，再用 MANIFEST.MF 中的每一块数据去校验每一个文件是否被修改。
 
 - 如何防止篡改
 假如攻击者修改了其中某一个文件，那么他必须修改 MANIFEST.MF 中对应文件的摘要，否则这个文件校验不通过； 
 接着还得修改 CERT.SF 中的摘要，否则摘要校验不过； 
 还得重新计算 CERT.SF 的签名，否则签名校验不通过； 
 但是计算签名需要私钥，私钥在开发者手中，攻击者没有私钥，所以无法签名。
 
 - 问题
 校验速度慢：需要对 apk 中的每个文件都计算摘要并验证，如果文件很多，校验时间会很长。
  完整性不够：V1 签名只会校验 Zip 文件中的部分文件，例如 META-INFO 文件夹就不会参与校验。
## v2签名（7.0）
V2 签名是在 Android7.0 之后引入的，它解决了 V1 签名校验时速度慢的问题，
同时对完整性的校验扩展到整个安装包。
## v3签名（9.0）
V3 签名方案的签名块格式和V2完全一样，只是 V2 的签名块信息存放在 ID = 0x7109871a 的数据块中
而 V3 的签名信息存放在 ID = 0xf05368c0 的数据块中。
在这个新的数据块中，记录了旧的签名信息和新的签名信息，以密钥转轮的方案，做签名的替换和升级。
这意味着我们可以更改 APK 的签名。
## v4签名（11.0)
apkv4签名允许您使用Android 11中的ADB增量APK安装快速部署大型APK。
   这个新标志负责部署过程中的APK签名步骤


v1-v3 参考https://zhuanlan.zhihu.com/p/108034286